local function GetPlayerData()
    if getgenv().PlayerData then return getgenv().PlayerData end
    for _, v in pairs(getgc(true)) do
        if type(v) == "table" and rawget(v, "Attributes") and rawget(v, "YenUpgrades") then
            getgenv().PlayerData = v
            return v
        end
    end
end

local PlayerData = GetPlayerData()
-- for k, v in pairs(PlayerData) do
--     if type(v) == "table" then
--         print("Found Table Key: " .. k)
--         -- ‡∏ñ‡πâ‡∏≤‡πÄ‡∏à‡∏≠‡πÇ‡∏ï‡πä‡∏∞‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏á‡∏™‡∏±‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô 'Avatar' ‡πÉ‡∏´‡πâ‡∏•‡∏≠‡∏á‡∏™‡πà‡∏≠‡∏á‡∏î‡∏π‡∏Ç‡πâ‡∏≤‡∏á‡πÉ‡∏ô
--         if k:lower():find("avatar") then
--             for subK, subV in pairs(v) do
--                 print("   --> SubKey: " .. subK .. " | Value: " .. tostring(subV))
--             end
--         end
--     elseif tostring(k):lower():find("avatar") then
--         print("Found Value Key: " .. k .. " | Value: " .. tostring(v))
--     end
-- end

local found = false
print("üîç --- Searching for Equipped Avatar ---")

-- -- 1. ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ö‡∏ô‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á PlayerData
-- for k, v in pairs(PlayerData) do
--     if string.find(string.lower(k), "avatar") then
--         if type(v) == "string" then
--             print(string.format("‚úÖ [Found String] Key: %s | Value: %s", k, v))
--             found = true
--         elseif type(v) == "table" then
--             print(string.format("üìÇ [Found Table] Key: %s", k))
--             -- ‡∏™‡πà‡∏≠‡∏á‡∏î‡∏π‡∏Ç‡πâ‡∏≤‡∏á‡πÉ‡∏ô Table ‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡πà‡∏≤‡πÉ‡∏™‡πà‡∏ï‡∏±‡∏ß‡πÑ‡∏´‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏´‡∏°
--             for subK, subV in pairs(v) do
--                 -- if subK == "Equipped" or subK == "Current" or subK == "Name" then
--                     print(string.format("   ‚û°Ô∏è SubKey: %s | Value: %s", subK, tostring(subV)))
--                     found = true
--                 -- end
--             end
--         end
--     end
-- end

local PlayerData = GetPlayerData()
if not PlayerData then 
    print("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö PlayerData") 
    return 
end

print("------------------------------------------")
print("üîç ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Avatar ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏ß‡∏°‡πÉ‡∏™‡πà")
print("------------------------------------------")

local function DeepScan(tab, depth, path)
    if depth > 4 then return end -- ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡πâ‡∏≤‡∏á
    for k, v in pairs(tab) do
        local currentPath = path .. "." .. tostring(k)
        local keyLower = tostring(k):lower()
        
        -- ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏µ‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏á‡∏™‡∏±‡∏¢ (Avatar, Equipped, Hero, Level, Craft)
        if keyLower:find("avatar") or keyLower:find("equipped") or keyLower:find("hero") or keyLower:find("level") or keyLower:find("craft") then
            if type(v) == "table" then
                print(string.format("üìÇ [TABLE] Path: %s", currentPath))
                -- ‡∏™‡πÅ‡∏Å‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏ô‡∏ï‡πà‡∏≠
                for subK, subV in pairs(v) do
                    print(string.format("   ‚û°Ô∏è %s = %s", tostring(subK), tostring(subV)))
                end
            else
                print(string.format("‚úÖ [VALUE] Path: %s | Value: %s", currentPath, tostring(v)))
            end
        end
        
        -- ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô Table ‡πÉ‡∏´‡πâ‡∏™‡πÅ‡∏Å‡∏ô‡∏•‡∏∂‡∏Å‡∏•‡∏á‡πÑ‡∏õ‡∏≠‡∏µ‡∏Å
        if type(v) == "table" and k ~= "_G" and k ~= "shared" then
            DeepScan(v, depth + 1, currentPath)
        end
    end
end

DeepScan(PlayerData, 1, "PlayerData")
print("------------------------------------------")
print("üèÅ ‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô")